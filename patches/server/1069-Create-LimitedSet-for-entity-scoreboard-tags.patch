From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Intybyte <vaan.testwork@gmail.com>
Date: Mon, 21 Oct 2024 01:41:04 +0200
Subject: [PATCH] Create LimitedSet for entity scoreboard tags


diff --git a/src/main/java/net/minecraft/world/entity/Entity.java b/src/main/java/net/minecraft/world/entity/Entity.java
index 4b54d0ea31062972e68ee8fafe3cfaf68f65a5cd..2711cd3b13686efdb3227cf681ddcf98ee82fd06 100644
--- a/src/main/java/net/minecraft/world/entity/Entity.java
+++ b/src/main/java/net/minecraft/world/entity/Entity.java
@@ -566,7 +566,7 @@ public abstract class Entity implements SyncedDataHolder, Nameable, EntityAccess
         this.packetPositionCodec = new VecDeltaCodec();
         this.uuid = Mth.createInsecureUUID(this.random);
         this.stringUUID = this.uuid.toString();
-        this.tags = Sets.newHashSet();
+        this.tags = new io.papermc.paper.util.SizeLimitedSet<>(new it.unimi.dsi.fastutil.objects.ObjectOpenHashSet<>(), MAX_ENTITY_TAG_COUNT);
         this.pistonDeltas = new double[]{0.0D, 0.0D, 0.0D};
         this.mainSupportingBlockPos = Optional.empty();
         this.onGroundNoBlocks = false;
@@ -654,7 +654,7 @@ public abstract class Entity implements SyncedDataHolder, Nameable, EntityAccess
     }
 
     public boolean addTag(String tag) {
-        return this.tags.size() >= 1024 ? false : this.tags.add(tag);
+        return this.tags.add(tag); // Paper - Create Limited set for Entity
     }
 
     public boolean removeTag(String tag) {
